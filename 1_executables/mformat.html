<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Mon Apr  7 17:28:24 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>mformat</title>

</head>
<body>

<h1 align="center">mformat</h1>

<a href="#Name">Name</a><br>
<a href="#Note&nbsp;of&nbsp;warning">Note&nbsp;of&nbsp;warning</a><br>
<a href="#Description">Description</a><br>
<a href="#Options">Options</a><br>
<a href="#Number&nbsp;of&nbsp;sectors&nbsp;per&nbsp;cluster">Number&nbsp;of&nbsp;sectors&nbsp;per&nbsp;cluster</a><br>
<a href="#See&nbsp;Also">See&nbsp;Also</a><br>
<a href="#Viewing&nbsp;the&nbsp;texi&nbsp;doc">Viewing&nbsp;the&nbsp;texi&nbsp;doc</a><br>

<hr>


<h2>Name
<a name="Name"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">mformat - add an
MSDOS filesystem to a low-level formatted floppy disk</p>

<h2>Note&nbsp;of&nbsp;warning
<a name="Note&nbsp;of&nbsp;warning"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">This manpage has
been automatically generated from mtools&rsquo;s texinfo
documentation, and may not be entirely accurate or complete.
See the end of this man page for details.</p>

<h2>Description
<a name="Description"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">The mformat
command is used to add an MS-DOS file system to a low-level
formatted diskette. Its syntax is:</p>

<p style="margin-left:9%; margin-top: 1em">mformat [-t
<i>cylinders</i>|-T <i>tot_sectors</i>] [-h <i>heads</i>]
[-s <i>sectors</i>] <br>
[-f <i>size</i>] [-1] [-4] [-8] <br>
[-v <i>volume_label</i>] <br>
[-F] [-S <i>sizecode</i>] <br>
[-M <i>software_sector_size</i>] <br>
[-N <i>serial_number</i>] [-a] <br>
[-C] [-H <i>hidden_sectors</i>] [-I <i>fsVersion</i>] <br>
[-r <i>root_sectors</i>] [-L <i>fat_len</i>] <br>
[-B <i>boot_sector</i>] [-k] <br>
[-m <i>media_descriptor</i>] <br>
[-K <i>backup_boot</i>] <br>
[-R <i>nb_reserved_sectors</i>] <br>
[-c <i>clusters_per_sector</i>] <br>
[-d <i>fat_copies</i>] <br>
[-X] [-2 <i>sectors_on_track_0</i>] [-3] <br>
[-0 <i>rate_on_track_0</i>] [-A <i>rate_on_other_tracks</i>]
<i><br>
drive:</i></p>

<p style="margin-left:9%; margin-top: 1em">Mformat adds a
minimal MS-DOS file system (boot sector, FAT, and root
directory) to a diskette that has already been formatted by
a Unix low-level format.</p>

<p style="margin-left:9%; margin-top: 1em">The following
options are supported: (The S, 2, 1 and M options may not
exist if this copy of mtools has been compiled without the
USE_2M option)</p>

<p style="margin-left:9%; margin-top: 1em">The following
options are the same as for MS-DOS&rsquo;s format
command:</p>

<h2>Options
<a name="Options"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p style="margin-top: 1em">v&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p style="margin-top: 1em">Specifies the volume label. A
volume label identifies the disk and can be a maximum of 11
characters. If you omit the -v switch, mformat will assign
no label to the disk.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>f&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>Specifies the size of the DOS file system to format.
Only a certain number of predefined sizes are supported by
this flag; for others use the -h/-t/-s flags. The following
sizes are supported:</p></td></tr>
</table>

<p style="margin-left:18%;">160&nbsp;</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="15%"></td>
<td width="3%"></td>
<td width="73%">


<p style="margin-top: 1em">160K, single-sided, 8 sectors
per track, 40 cylinders (for 5 1/4 DD)</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="15%">


<p>180&nbsp;</p></td>
<td width="3%"></td>
<td width="73%">


<p>160K, single-sided, 9 sectors per track, 40 cylinders
(for 5 1/4 DD)</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="15%">


<p>320&nbsp;</p></td>
<td width="3%"></td>
<td width="73%">


<p>320K, double-sided, 8 sectors per track, 40 cylinders
(for 5 1/4 DD)</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="15%">


<p>360&nbsp;</p></td>
<td width="3%"></td>
<td width="73%">


<p>360K, double-sided, 9 sectors per track, 40 cylinders
(for 5 1/4 DD)</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="15%">


<p>720&nbsp;</p></td>
<td width="3%"></td>
<td width="73%">


<p>720K, double-sided, 9 sectors per track, 80 cylinders
(for 3 1/2 DD)</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="15%">


<p>1200&nbsp;</p></td>
<td width="3%"></td>
<td width="73%">


<p>1200K, double-sided, 15 sectors per track, 80 cylinders
(for 5 1/4 HD)</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="15%">


<p>1440&nbsp;</p></td>
<td width="3%"></td>
<td width="73%">


<p>1440K, double-sided, 18 sectors per track, 80 cylinders
(for 3 1/2 HD)</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="15%">


<p>2880&nbsp;</p></td>
<td width="3%"></td>
<td width="73%">


<p>2880K, double-sided, 36 sectors per track, 80 cylinders
(for 3 1/2 ED)</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="15%">


<p>t&nbsp;</p></td>
<td width="3%"></td>
<td width="73%">
</td></tr>
</table>

<p style="margin-left:18%; margin-top: 1em">Specifies the
number of tracks on the disk.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p style="margin-top: 1em">T&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p style="margin-top: 1em">Specifies the number of total
sectors on the disk. Only one of these 2 options may be
specified (tracks or total sectors)</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>h&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>The number of heads (sides).</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>s&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>Specifies the number of sectors per track. If the 2m
option is given, number of 512-byte sector equivalents on
generic tracks (i.e. not head 0 track 0). If the 2m option
is not given, number of physical sectors per track (which
may be bigger than 512 bytes).</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>1&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>Formats a single side (equivalent to -h 1)</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>4&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>Formats a 360K double-sided disk (equivalent to -f 360).
When used together with -the 1 switch, this switch formats a
180K disk</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>8&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>Formats a disk with 8 sectors per track.</p></td></tr>
</table>

<p style="margin-left:9%; margin-top: 1em">MS-DOS
format&rsquo;s q, u and b options are not supported, and s
has a different meaning.</p>

<p style="margin-left:9%; margin-top: 1em">The following
options are specific to mtools:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p style="margin-top: 1em">F&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p style="margin-top: 1em">Format the partition as
FAT32.</p> </td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>S&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>The size code. The size of the sector is 2 &#710;
(sizecode + 7).</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>X&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>formats the disk as an XDF disk. See section XDF, for
more details. The disk has first to be low-level formatted
using the xdfcopy utility included in the fdutils package.
XDF disks are used for instance for OS/2 install disks.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>2&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>2m format. The parameter to this option describes the
number of sectors on track 0, head 0. This option is
recommended for sectors bigger than normal.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>3&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>don&rsquo;t use a 2m format, even if the current
geometry of the disk is a 2m geometry.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>0&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>Data transfer rate on track 0</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>A&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>Data transfer rate on tracks other than 0</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>M&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>software sector size. This parameter describes the
sector size in bytes used by the MS-DOS file system. By
default it is the physical sector size.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>N&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>Uses the requested serial number, instead of generating
one automatically</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>a&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>If this option is given, an Atari style serial number is
generated. Ataris store their serial number in the OEM
label.</p> </td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>C&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>creates the disk image file to install the MS-DOS file
system on it. Obviously, this is useless on physical devices
such as floppies and hard disk partitions, but is
interesting for image files.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>H&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>number of hidden sectors. This parameter is useful for
formatting hard disk partition, which are not aligned on
track boundaries (i.e. first head of first track
doesn&rsquo;t belong to the partition, but contains a
partition table). In that case the number of hidden sectors
is in general the number of sectors per cylinder. This is
untested.</p> </td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>I&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>Sets the fsVersion id when formatting a FAT32 drive. In
order to find this out, run minfo on an existing FAT32
drive, and mail me about it, so I can include the correct
value in future versions of mtools.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>c&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>Sets the size of a cluster (in sectors). If this cluster
size would generate a FAT that too big for its number of
bits, mtools automatically increases the cluster size, until
the FAT is small enough. If no cluster size is specified
explicitly, mtools uses a default value as described in
section &lsquo;&lsquo;Number of sectors per
cluster&rsquo;&rsquo; below.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>d&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>Sets the number of FAT copies. Default is 2. This
setting can also be specified using the MTOOLS_NFATS
environment variable.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>r&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>Sets the size of the root directory (in sectors). Only
applicable to 12 and 16 bit FATs. This setting can also be
specified using the MTOOLS_DIR_LEN environment variable.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>L&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>Sets the length of the FAT.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>B&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>Use the boot sector stored in the given file or device,
instead of using its own. Only the geometry fields are
updated to match the target disks parameters.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>k&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>Keep the existing boot sector as much as possible. Only
the geometry fields and other similar file system data are
updated to match the target disks parameters.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>K&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>Sets the sector number where the backup of the boot
sector should be stored (only relevant on FAT32).</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>R&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>Sets the number of reserved sectors for this filesystem.
This must be at least 1 for non-FAT32 disks, and at least 3
for FAT disks (in order to accommodate the boot sector, the
info sector and the backup boot sector).</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>m&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>Use a non-standard media descriptor byte for this disk.
The media descriptor is stored at position 21 of the boot
sector, and as first byte in each FAT copy. Using this
option may confuse DOS or older mtools version, and may make
the disk unreadable. Only use if you know what you are
doing.</p> </td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p>b&nbsp;</p></td>
<td width="6%"></td>
<td width="82%">


<p>Use a non-standard bios disk number for this disk. By
default, bios disk number is inferred from media descriptor:
0x80 for media descriptor 0xf8, or 0x00 otherwise.</p></td></tr>
</table>

<p style="margin-left:9%; margin-top: 1em">To format a
diskette at a density other than the default, you must
supply (at least) those command line parameters that are
different from the default.</p>

<p style="margin-left:9%; margin-top: 1em">Mformat returns
0 on success or 1 on failure.</p>

<p style="margin-left:9%; margin-top: 1em">It doesn&rsquo;t
record bad block information to the Fat, use mbadblocks for
that.</p>

<h2>Number&nbsp;of&nbsp;sectors&nbsp;per&nbsp;cluster
<a name="Number&nbsp;of&nbsp;sectors&nbsp;per&nbsp;cluster"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">If the user
indicates no cluster size, mformat figures out a default
value for it.</p>

<p style="margin-left:9%; margin-top: 1em">For FAT32 it
uses the following table to determine the number of sectors
per cluster, depending on the total number of sectors on the
filesystem.</p>

<p style="margin-left:9%; margin-top: 1em">more than
32*1024*1024*2: 64 sectors <br>
between 16*1024*1024*2 and 32*1024*1024*2: 32 sectors <br>
between 8*1024*1024*2 and 16*1024*1024*2: 16 sectors <br>
between 260*1024*2 and 81024*1024*2: 1 sectors</p>

<p style="margin-left:9%; margin-top: 1em">This is derived
from information on page 20 of Microsoft&rsquo;s fatgen103
document, which currently can be found at the following
address:</p>


<p style="margin-left:9%; margin-top: 1em">https://staff.washington.edu/dittrich/misc/fatgen103.pdf</p>

<p style="margin-left:9%; margin-top: 1em">For FAT12 and
FAT16, mformat uses an iterative approach, where it starts
with a set value, which it doubles until it is able to fill
up the disk using that cluster size and a number of cluster
less than the maximum allowed.</p>

<p style="margin-left:9%; margin-top: 1em">The starting
value is 1 for disks with one head or less than 2000
sectors, and 2 for disks with more than one head, and more
than 2000 sectors.</p>

<p style="margin-left:9%; margin-top: 1em">The number of
sectors per cluster cannot go beyond 128.</p>

<h2>See&nbsp;Also
<a name="See&nbsp;Also"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">Mtools&rsquo;
texinfo doc</p>

<h2>Viewing&nbsp;the&nbsp;texi&nbsp;doc
<a name="Viewing&nbsp;the&nbsp;texi&nbsp;doc"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">This manpage has
been automatically generated from mtools&rsquo;s texinfo
documentation. However, this process is only approximative,
and some items, such as crossreferences, footnotes and
indices are lost in this translation process. Indeed, these
items have no appropriate representation in the manpage
format. Moreover, not all information has been translated
into the manpage version. Thus I strongly advise you to use
the original texinfo doc. See the end of this manpage for
instructions how to view the texinfo doc.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="5%">


<p style="margin-top: 1em">* &nbsp;&nbsp;</p></td>
<td width="4%"></td>
<td width="82%">


<p style="margin-top: 1em">To generate a printable copy
from the texinfo doc, run the following commands:</p></td></tr>
</table>


<p style="margin-left:22%; margin-top: 1em"><b>./configure;
make dvi; dvips mtools.dvi</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="5%">


<p style="margin-top: 1em">* &nbsp;&nbsp;</p></td>
<td width="4%"></td>
<td width="38%">


<p style="margin-top: 1em">To generate a html copy,
run:</p> </td>
<td width="44%">
</td></tr>
</table>


<p style="margin-left:22%; margin-top: 1em"><b>./configure;
make html</b></p>

<p style="margin-left:9%; margin-top: 1em">A premade html
can be found at
&lsquo;http://www.gnu.org/software/mtools/manual/mtools.html&rsquo;</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="5%">


<p style="margin-top: 1em">* &nbsp;&nbsp;</p></td>
<td width="4%"></td>
<td width="82%">


<p style="margin-top: 1em">To generate an info copy
(browsable using emacs&rsquo; info mode), run:</p></td></tr>
</table>


<p style="margin-left:22%; margin-top: 1em"><b>./configure;
make info</b></p>

<p style="margin-left:9%; margin-top: 1em">The texinfo doc
looks most pretty when printed or as html. Indeed, in the
info version certain examples are difficult to read due to
the quoting conventions used in info.</p>
<hr>
</body>
</html>
