<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Mon Apr  7 17:29:08 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>ocsptool</title>

</head>
<body>

<h1 align="center">ocsptool</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#EXIT STATUS">EXIT STATUS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHORS">AUTHORS</a><br>
<a href="#COPYRIGHT">COPYRIGHT</a><br>
<a href="#BUGS">BUGS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em"><b>ocsptool</b>
- GnuTLS OCSP tool</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em"><b>ocsptool</b>
[<b>-flags</b>] [<b>-flag</b> [<i>value</i>]]
[<b>--option-name</b>[[=| ]<i>value</i>]]</p>

<p style="margin-left:9%; margin-top: 1em">All arguments
must be options.</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em"><b>On
verification</b> <br>
Responses are typically signed/issued by designated
certificates or certificate authorities and thus this tool
requires on verification the certificate of the issuer or
the full certificate chain in order to determine the
appropriate signing authority. The specified certificate of
the issuer is assumed trusted.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em"><b>-d</b>
<i>num</i>, <b>--debug</b>=<i>num</i> Enable debugging. This
option takes an integer <br>
number as its argument. The value of <i>num</i> is
constrained to being:</p>

<p style="margin-left:14%;">in the range 0 through 9999</p>

<p style="margin-left:9%; margin-top: 1em">Specifies the
debug level.</p>

<p style="margin-left:9%; margin-top: 1em"><b>-V</b>,
<b>--verbose</b> More verbose output.</p>


<p style="margin-left:9%; margin-top: 1em"><b>--infile</b>=<i>file</i>
Input file.</p>


<p style="margin-left:9%; margin-top: 1em"><b>--outfile</b>=<i>str</i>
Output file.</p>


<p style="margin-left:9%; margin-top: 1em"><b>--ask</b>=<i>server
name|url</i> Ask an OCSP/HTTP server on a certificate <br>
validity.</p>

<p style="margin-left:9%; margin-top: 1em">Connects to the
specified HTTP OCSP server and queries on the validity <br>
of the loaded certificate. Its argument can be a URL or a
plain server <br>
name. It can be combined with --load-chain, where it checks
all <br>
certificates in the provided chain, or with --load-cert and
<br>
--load-issuer options. The latter checks the provided
certificate <br>
against its specified issuer certificate.</p>

<p style="margin-left:9%; margin-top: 1em"><b>-e</b>,
<b>--verify-response</b> Verify response.</p>

<p style="margin-left:9%; margin-top: 1em">Verifies the
provided OCSP response against the system trust anchors <br>
(unless --load-trust is provided). It requires the
--load-signer or <br>
--load-chain options to obtain the signer of the OCSP
response.</p>

<p style="margin-left:9%; margin-top: 1em"><b>-i</b>,
<b>--request-info</b> Print information on a OCSP
request.</p>

<p style="margin-left:9%; margin-top: 1em">Display detailed
information on the provided OCSP request.</p>

<p style="margin-left:9%; margin-top: 1em"><b>-j</b>,
<b>--response-info</b> Print information on a OCSP
response.</p>

<p style="margin-left:9%; margin-top: 1em">Display detailed
information on the provided OCSP response.</p>

<p style="margin-left:9%; margin-top: 1em"><b>-q</b>,
<b>--generate-request</b> Generates an OCSP request.</p>

<p style="margin-left:9%; margin-top: 1em"><b>--nonce</b>,
<b>--no-nonce</b> Use (or not) a nonce to OCSP request. The
<i>no-nonce</i> <br>
form will disable the option.</p>


<p style="margin-left:9%; margin-top: 1em"><b>--load-chain</b>=<i>file</i>
Reads a set of certificates forming a chain from <br>
file.</p>


<p style="margin-left:9%; margin-top: 1em"><b>--load-issuer</b>=<i>file</i>
Reads issuer&rsquo;s certificate from file.</p>


<p style="margin-left:9%; margin-top: 1em"><b>--load-cert</b>=<i>file</i>
Reads the certificate to check from file.</p>


<p style="margin-left:9%; margin-top: 1em"><b>--load-trust</b>=<i>file</i>
Read OCSP trust anchors from file. This option must <br>
not appear in combination with any of the following options:
<br>
load-signer.</p>

<p style="margin-left:9%; margin-top: 1em">When verifying
an OCSP response read the trust anchors from the <br>
provided file. When this is not provided, the system&rsquo;s
trust anchors <br>
will be used.</p>


<p style="margin-left:9%; margin-top: 1em"><b>--load-signer</b>=<i>file</i>
Reads the OCSP response signer from file. This <br>
option must not appear in combination with any of the
following <br>
options: load-trust.</p>

<p style="margin-left:9%; margin-top: 1em"><b>--inder</b>,
<b>--no-inder</b> Use DER format for input certificates and
private <br>
keys. The <i>no-inder</i> form will disable the option.</p>

<p style="margin-left:9%; margin-top: 1em"><b>--outder</b>
Use DER format for output of responses (this is the
default).</p>

<p style="margin-left:9%; margin-top: 1em">The output will
be in DER encoded format. Unlike other GnuTLS tools, <br>
this is the default for this tool</p>

<p style="margin-left:9%; margin-top: 1em"><b>--outpem</b>
Use PEM format for output of responses.</p>

<p style="margin-left:9%; margin-top: 1em">The output will
be in PEM format.</p>

<p style="margin-left:9%; margin-top: 1em"><b>-Q</b>
<i>file</i>, <b>--load-request</b>=<i>file</i> Reads the DER
encoded OCSP request from <br>
file.</p>

<p style="margin-left:9%; margin-top: 1em"><b>-S</b>
<i>file</i>, <b>--load-response</b>=<i>file</i> Reads the
DER encoded OCSP response from <br>
file.</p>


<p style="margin-left:9%; margin-top: 1em"><b>--ignore-errors</b>
Ignore any verification errors.</p>


<p style="margin-left:9%; margin-top: 1em"><b>--verify-allow-broken</b>
Allow broken algorithms, such as MD5 for <br>
verification.</p>

<p style="margin-left:9%; margin-top: 1em">This can be
combined with --verify-response.</p>


<p style="margin-left:9%; margin-top: 1em"><b>--attime</b>=<i>timestamp</i>
Perform validation at the timestamp instead of the <br>
system time.</p>

<p style="margin-left:9%; margin-top: 1em">timestamp is an
instance in time encoded as Unix time or in a human <br>
readable timestring such as &quot;29 Feb 2004&quot;,
&quot;2004-02-29&quot;. Full <br>
documentation available at <br>

&lt;https://www.gnu.org/software/coreutils/manual/html_node/Date-input-formats.html&gt;
<br>
or locally via info &rsquo;(coreutils) date
invocation&rsquo;.</p>

<p style="margin-left:9%; margin-top: 1em"><b>-v</b>
<i>arg</i>, <b>--version</b>=<i>arg</i> Output version of
program and exit. The default <br>
mode is &lsquo;v&rsquo;, a simple version. The
&lsquo;c&rsquo; mode will print copyright <br>
information and &lsquo;n&rsquo; will print the full
copyright notice.</p>

<p style="margin-left:9%; margin-top: 1em"><b>-h</b>,
<b>--help</b> Display usage information and exit.</p>

<p style="margin-left:9%; margin-top: 1em"><b>-!</b>,
<b>--more-help</b> Pass the extended usage information
through a pager.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:18%; margin-top: 1em"><b>Print
information about an OCSP request</b></p>

<p style="margin-left:18%; margin-top: 1em">To parse an
OCSP request and print information about the content, the
<b>-i</b> or <b>--request-info</b> parameter may be used as
follows. The <b>-Q</b> parameter specify the name of the
file containing the OCSP request, and it should contain the
OCSP request in binary DER format.</p>

<p style="margin-left:23%; margin-top: 1em">$ ocsptool -i
-Q ocsp-request.der</p>

<p style="margin-left:18%; margin-top: 1em">The input file
may also be sent to standard input like this:</p>

<p style="margin-left:23%; margin-top: 1em">$ cat
ocsp-request.der | ocsptool --request-info</p>

<p style="margin-left:18%; margin-top: 1em"><b>Print
information about an OCSP response</b></p>

<p style="margin-left:18%; margin-top: 1em">Similar to
parsing OCSP requests, OCSP responses can be parsed using
the <b>-j</b> or <b>--response-info</b> as follows.</p>

<p style="margin-left:23%; margin-top: 1em">$ ocsptool -j
-Q ocsp-response.der <br>
$ cat ocsp-response.der | ocsptool --response-info</p>

<p style="margin-left:18%; margin-top: 1em"><b>Generate an
OCSP request</b></p>

<p style="margin-left:18%; margin-top: 1em">The <b>-q</b>
or <b>--generate-request</b> parameters are used to generate
an OCSP request. By default the OCSP request is written to
standard output in binary DER format, but can be stored in a
file using <b>--outfile</b>. To generate an OCSP request the
issuer of the certificate to check needs to be specified
with <b>--load-issuer</b> and the certificate to check with
<b>--load-cert</b>. By default PEM format is used for these
files, although <b>--inder</b> can be used to specify that
the input files are in DER format.</p>

<p style="margin-left:23%; margin-top: 1em">$ ocsptool -q
--load-issuer issuer.pem --load-cert client.pem --outfile
ocsp-request.der</p>

<p style="margin-left:18%; margin-top: 1em">When generating
OCSP requests, the tool will add an OCSP extension
containing a nonce. This behaviour can be disabled by
specifying <b>--no-nonce</b>.</p>

<p style="margin-left:18%; margin-top: 1em"><b>Verify
signature in OCSP response</b></p>

<p style="margin-left:18%; margin-top: 1em">To verify the
signature in an OCSP response the <b>-e</b> or
<b>--verify-response</b> parameter is used. The tool will
read an OCSP response in DER format from standard input, or
from the file specified by <b>--load-response</b>. The OCSP
response is verified against a set of trust anchors, which
are specified using <b>--load-trust</b>. The trust anchors
are concatenated certificates in PEM format. The certificate
that signed the OCSP response needs to be in the set of
trust anchors, or the issuer of the signer certificate needs
to be in the set of trust anchors and the OCSP Extended Key
Usage bit has to be asserted in the signer certificate.</p>

<p style="margin-left:23%; margin-top: 1em">$ ocsptool -e
--load-trust issuer.pem --load-response
ocsp-response.der</p>

<p style="margin-left:18%; margin-top: 1em">The tool will
print status of verification.</p>

<p style="margin-left:18%; margin-top: 1em"><b>Verify
signature in OCSP response against given certificate</b></p>

<p style="margin-left:18%; margin-top: 1em">It is possible
to override the normal trust logic if you know that a
certain certificate is supposed to have signed the OCSP
response, and you want to use it to check the signature.
This is achieved using <b>--load-signer</b> instead of
<b>--load-trust</b>. This will load one certificate and it
will be used to verify the signature in the OCSP response.
It will not check the Extended Key Usage bit.</p>

<p style="margin-left:23%; margin-top: 1em">$ ocsptool -e
--load-signer ocsp-signer.pem --load-response
ocsp-response.der</p>

<p style="margin-left:18%; margin-top: 1em">This approach
is normally only relevant in two situations. The first is
when the OCSP response does not contain a copy of the signer
certificate, so the <b>--load-trust</b> code would fail. The
second is if you want to avoid the indirect mode where the
OCSP response signer certificate is signed by a trust
anchor.</p>

<p style="margin-left:18%; margin-top: 1em"><b>Real-world
example</b></p>

<p style="margin-left:18%; margin-top: 1em">Here is an
example of how to generate an OCSP request for a certificate
and to verify the response. For illustration we&rsquo;ll use
the <b>blog.josefsson.org</b> host, which (as of writing)
uses a certificate from CACert. First we&rsquo;ll use
<b>gnutls-cli</b> to get a copy of the server certificate
chain. The server is not required to send this information,
but this particular one is configured to do so.</p>

<p style="margin-left:23%; margin-top: 1em">$ echo |
gnutls-cli -p 443 blog.josefsson.org --save-cert
chain.pem</p>

<p style="margin-left:18%; margin-top: 1em">The saved
certificates normally contain a pointer to where the OCSP
responder is located, in the Authority Information Access
Information extension. For example, from <b>certtool -i &lt;
chain.pem</b> there is this information:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="7%"></td>
<td width="6%"></td>
<td width="7%">
</td>
<td width="74%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="7%"></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="74%">


<p>Authority Information Access Information (not
critical):</p> </td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="7%"></td>
<td width="6%"></td>
<td width="7%">
</td>
<td width="74%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="7%"></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="74%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="7%"></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="74%">


<p>Access Method: 1.3.6.1.5.5.7.48.1 (id-ad-ocsp)</p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="7%"></td>
<td width="6%"></td>
<td width="7%">
</td>
<td width="74%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="7%"></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="74%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="7%"></td>
<td width="6%"></td>
<td width="7%"></td>
<td width="74%">


<p>Access Location URI: https://ocsp.CAcert.org/</p></td></tr>
</table>

<p style="margin-left:18%; margin-top: 1em">This means that
ocsptool can discover the servers to contact over HTTP. We
can now request information on the chain certificates.</p>

<p style="margin-left:23%; margin-top: 1em">$ ocsptool
--ask --load-chain chain.pem</p>

<p style="margin-left:18%; margin-top: 1em">The request is
sent via HTTP to the OCSP server address found in the
certificates. It is possible to override the address of the
OCSP server as well as ask information on a particular
certificate using --load-cert and --load-issuer.</p>

<p style="margin-left:23%; margin-top: 1em">$ ocsptool
--ask https://ocsp.CAcert.org/ --load-chain chain.pem</p>

<h2>EXIT STATUS
<a name="EXIT STATUS"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">One of the
following exit values will be returned: <br>
0 (EXIT_SUCCESS) Successful program execution.</p>

<p style="margin-left:9%; margin-top: 1em">1 (EXIT_FAILURE)
The operation failed or the command syntax was not <br>
valid.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:18%; margin-top: 1em">certtool
(1)</p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>


<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">Copyright (C)
2020-2023 Free Software Foundation, and others all rights
reserved. This program is released under the terms of the
GNU General Public License, version 3 or later</p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">Please send bug
reports to: bugs@gnutls.org</p>
<hr>
</body>
</html>
