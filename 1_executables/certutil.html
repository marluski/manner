<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Mon Apr  7 17:23:00 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>CERTUTIL</title>

</head>
<body>

<h1 align="center">CERTUTIL</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#STATUS">STATUS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#COMMAND OPTIONS AND ARGUMENTS">COMMAND OPTIONS AND ARGUMENTS</a><br>
<a href="#USAGE AND EXAMPLES">USAGE AND EXAMPLES</a><br>
<a href="#NSS DATABASE TYPES">NSS DATABASE TYPES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#ADDITIONAL RESOURCES">ADDITIONAL RESOURCES</a><br>
<a href="#AUTHORS">AUTHORS</a><br>
<a href="#LICENSE">LICENSE</a><br>
<a href="#NOTES">NOTES</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">certutil -
Manage keys and certificate in both NSS databases and other
NSS tokens</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="41%">


<p style="margin-top: 1em"><b>certutil</b> [<i>options</i>]
[[<i>arguments</i>]]</p> </td>
<td width="50%">
</td></tr>
</table>

<h2>STATUS
<a name="STATUS"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">This
documentation is still work in progress. Please contribute
to the initial review in <b><font color="#0000FF">Mozilla
NSS bug 836477</font></b>
<small><font color="#000000">[1]</font></small></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:9%; margin-top: 1em"><font color="#000000">The
Certificate Database Tool, <b>certutil</b>, is a
command-line utility that can create and modify certificate
and key databases. It can specifically list, generate,
modify, or delete certificates, create or change the
password, generate new public and private key pairs, display
the contents of the key database, or delete key pairs within
the key database.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Certificate
issuance, part of the key and certificate management
process, requires that keys and certificates be created in
the key database. This document discusses certificate and
key database management. For information on the security
module database management, see the <b>modutil</b>
manpage.</font></p>

<h2>COMMAND OPTIONS AND ARGUMENTS
<a name="COMMAND OPTIONS AND ARGUMENTS"></a>
</h2>



<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Running
<b>certutil</b> always requires one and only one command
option to specify the type of certificate operation. Each
command option may take zero or more arguments. The command
option <b>-H</b> will list all the command options and their
relevant arguments.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>Command
Options</b></font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-A</font></p>

<p style="margin-left:14%;"><font color="#000000">Add an
existing certificate to a certificate database. The
certificate database should already exist; if one is not
present, this command option will initialize one by
default.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-B</font></p>

<p style="margin-left:14%;"><font color="#000000">Run a
series of commands from the specified batch file. This
requires the <b>-i</b> argument.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-C</font></p>

<p style="margin-left:14%;"><font color="#000000">Create a
new binary certificate file from a binary certificate
request file. Use the <b>-i</b> argument to specify the
certificate request file. If this argument is not used,
<b>certutil</b> prompts for a filename.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-D</font></p>

<p style="margin-left:14%;"><font color="#000000">Delete a
certificate from the certificate database.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--rename</font></p>

<p style="margin-left:14%;"><font color="#000000">Change
the database nickname of a certificate.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-E</font></p>

<p style="margin-left:14%;"><font color="#000000">Add an
email certificate to the certificate database.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-F</font></p>

<p style="margin-left:14%;"><font color="#000000">Delete a
private key and the associated certificate from a database.
Specify the key to delete with the -n argument or the -k
argument. Specify the database from which to delete the key
with the <b>-d</b> argument.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">Some
smart cards do not let you remove a public key you have
generated. In such a case, only the private key is deleted
from the key pair.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-G</font></p>

<p style="margin-left:14%;"><font color="#000000">Generate
a new public and private key pair within a key database. The
key database should already exist; if one is not present,
this command option will initialize one by default. Some
smart cards can store only one key pair. If you create a new
key pair for such a card, the previous pair is
overwritten.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-H</font></p>

<p style="margin-left:14%;"><font color="#000000">Display a
list of the command options and arguments.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-K</font></p>

<p style="margin-left:14%;"><font color="#000000">List the
key ID of keys in the key database. A key ID is the modulus
of the RSA key or the publicValue of the DSA key. IDs are
displayed in hexadecimal (&quot;0x&quot; is not
shown).</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-L</font></p>

<p style="margin-left:14%;"><font color="#000000">List all
the certificates, or display information about a named
certificate, in a certificate database. Use the -h tokenname
argument to specify the certificate database on a particular
hardware or software token.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-M</font></p>

<p style="margin-left:14%;"><font color="#000000">Modify a
certificate's trust attributes using the values of the -t
argument.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-N</font></p>

<p style="margin-left:14%;"><font color="#000000">Create
new certificate and key databases.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-O</font></p>

<p style="margin-left:14%;"><font color="#000000">Print the
certificate chain.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-R</font></p>

<p style="margin-left:14%;"><font color="#000000">Create a
certificate request file that can be submitted to a
Certificate Authority (CA) for processing into a finished
certificate. Output defaults to standard out unless you use
-o output-file argument. Use the -a argument to specify
ASCII output.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-S</font></p>

<p style="margin-left:14%;"><font color="#000000">Create an
individual certificate and add it to a certificate
database.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-T</font></p>

<p style="margin-left:14%;"><font color="#000000">Reset the
key database or token.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-U</font></p>

<p style="margin-left:14%;"><font color="#000000">List all
available modules or print a single named module.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-V</font></p>

<p style="margin-left:14%;"><font color="#000000">Check the
validity of a certificate and its attributes.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-W</font></p>

<p style="margin-left:14%;"><font color="#000000">Change
the password to a key database.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--merge</font></p>

<p style="margin-left:14%;"><font color="#000000">Merge two
databases into one.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--upgrade-merge</font></p>

<p style="margin-left:14%;"><font color="#000000">Upgrade
an old database and merge it into a new database. This is
used to migrate legacy NSS databases (cert8.db and key3.db)
into the newer SQLite databases (cert9.db and
key4.db).</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>Arguments</b></font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Arguments
modify a command option and are usually lower case, numbers,
or symbols.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-a</font></p>

<p style="margin-left:14%;"><font color="#000000">Use ASCII
format or allow the use of ASCII format for input or output.
This formatting follows RFC 1113. For certificate requests,
ASCII output defaults to standard output unless
redirected.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--simple-self-signed</font></p>

<p style="margin-left:14%;"><font color="#000000">When
printing the certificate chain, don't search for a chain if
issuer name equals to subject name.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-b
validity-time</font></p>

<p style="margin-left:14%;"><font color="#000000">Specify a
time at which a certificate is required to be valid. Use
when checking certificate validity with the <b>-V</b>
option. The format of the <i>validity-time</i> argument is
<i>YYMMDDHHMMSS[+HHMM|-HHMM|Z]</i>, which allows offsets to
be set relative to the validity end time. Specifying seconds
(<i>SS</i>) is optional. When specifying an explicit time,
use a Z at the end of the term, <i>YYMMDDHHMMSSZ</i>, to
close it. When specifying an offset time, use
<i>YYMMDDHHMMSS+HHMM</i> or <i>YYMMDDHHMMSS-HHMM</i> for
adding or subtracting time, respectively.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">If
this option is not used, the validity check defaults to the
current system time.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-c
issuer</font></p>

<p style="margin-left:14%;"><font color="#000000">Identify
the certificate of the CA from which a new certificate will
derive its authenticity. Use the exact nickname or alias of
the CA certificate, or use the CA's email address. Bracket
the issuer string with quotation marks if it contains
spaces.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-d
[prefix]directory</font></p>

<p style="margin-left:14%;"><font color="#000000">Specify
the database directory containing the certificate and key
database files.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000"><b>certutil</b>
supports two types of databases: the legacy security
databases (cert8.db, key3.db, and secmod.db) and new SQLite
databases (cert9.db, key4.db, and pkcs11.txt).</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">NSS
recognizes the following prefixes:</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
<b>sql:</b> requests the newer database</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
<b>dbm:</b> requests the legacy database</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">If
no prefix is specified the default type is retrieved from
NSS_DEFAULT_DB_TYPE. If NSS_DEFAULT_DB_TYPE is not set then
<b>sql:</b> is the default.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--dump-ext-val
OID</font></p>

<p style="margin-left:14%;"><font color="#000000">For
single cert, print binary DER encoding of extension
OID.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-e</font></p>

<p style="margin-left:14%;"><font color="#000000">Check a
certificate's signature during the process of validating a
certificate.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--email
email-address</font></p>

<p style="margin-left:14%;"><font color="#000000">Specify
the email address of a certificate to list. Used with the -L
command option.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--extGeneric
OID:critical-flag:filename[,OID:critical-flag:filename]...</font></p>

<p style="margin-left:14%;"><font color="#000000">Add one
or multiple extensions that certutil cannot encode yet, by
loading their encodings from external files.</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
OID (example): 1.2.3.4</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
critical-flag: critical or not-critical</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
filename: full path to a file containing an encoded
extension</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-f
password-file</font></p>

<p style="margin-left:14%;"><font color="#000000">Specify a
file that will automatically supply the password to include
in a certificate or to access a certificate database. This
is a plain-text file containing one password. Be sure to
prevent unauthorized access to this file.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-g
keysize</font></p>

<p style="margin-left:14%;"><font color="#000000">Set a key
size to use when generating new public and private key
pairs. The minimum is 512 bits and the maximum is 16384
bits. The default is 2048 bits. Any size between the minimum
and maximum is allowed.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-h
tokenname</font></p>

<p style="margin-left:14%;"><font color="#000000">Specify
the name of a token to use or act on. If not specified the
default token is the internal database slot.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">The
name can also be a PKCS #11 URI. For example, the NSS
internal certificate store can be unambiguously specified as
&quot;pkcs11:token=NSS%20Certificate%20DB&quot;. For details
about the format, see RFC 7512.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-i
input_file</font></p>

<p style="margin-left:14%;"><font color="#000000">Pass an
input file to the command. Depending on the command option,
an input file can be a specific certificate, a certificate
request file, or a batch file of commands.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-k
key-type-or-id</font></p>

<p style="margin-left:14%;"><font color="#000000">Specify
the type or specific ID of a key.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">The
valid key type options are rsa, dsa, ec, or all. The default
value is rsa. Specifying the type of key can avoid mistakes
caused by duplicate nicknames. Giving a key type generates a
new key pair; giving the ID of an existing key reuses that
key pair (which is required to renew
certificates).</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-l</font></p>

<p style="margin-left:14%;"><font color="#000000">Display
detailed information when validating a certificate with the
-V option.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-m
serial-number</font></p>

<p style="margin-left:14%;"><font color="#000000">Assign a
unique serial number to a certificate being created. This
operation should be performed by a CA. If no serial number
is provided a default serial number is made from the current
time. Serial numbers are limited to integers</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-n
nickname</font></p>

<p style="margin-left:14%;"><font color="#000000">Specify
the nickname of a certificate or key to list, create, add to
a database, modify, or validate. Bracket the nickname string
with quotation marks if it contains spaces.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">The
nickname can also be a PKCS #11 URI. For example, if you
have a certificate named &quot;my-server-cert&quot; on the
internal certificate store, it can be unambiguously
specified as
&quot;pkcs11:token=NSS%20Certificate%20DB;object=my-server-cert&quot;.
For details about the format, see RFC 7512.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-o
output-file</font></p>

<p style="margin-left:14%;"><font color="#000000">Specify
the output file name for new certificates or binary
certificate requests. Bracket the output-file string with
quotation marks if it contains spaces. If this argument is
not used the output destination defaults to standard
output.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-P
dbPrefix</font></p>

<p style="margin-left:14%;"><font color="#000000">Specify
the prefix used on the certificate and key database file.
This argument is provided to support legacy servers. Most
applications do not use a database prefix.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-p
phone</font></p>

<p style="margin-left:14%;"><font color="#000000">Specify a
contact telephone number to include in new certificates or
certificate requests. Bracket this string with quotation
marks if it contains spaces.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-q
pqgfile or curve-name</font></p>

<p style="margin-left:14%;"><font color="#000000">Read an
alternate PQG value from the specified file when generating
DSA key pairs. If this argument is not used, <b>certutil</b>
generates its own PQG value. PQG files are created with a
separate DSA utility.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">Elliptic
curve name is one of the ones from nistp256, nistp384,
nistp521, curve25519.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">If
a token is available that supports more curves, the
foolowing curves are supported as well: sect163k1, nistk163,
sect163r1, sect163r2, nistb163, sect193r1, sect193r2,
sect233k1, nistk233, sect233r1, nistb233, sect239k1,
sect283k1, nistk283, sect283r1, nistb283, sect409k1,
nistk409, sect409r1, nistb409, sect571k1, nistk571,
sect571r1, nistb571, secp160k1, secp160r1, secp160r2,
secp192k1, secp192r1, nistp192, secp224k1, secp224r1,
nistp224, secp256k1, secp256r1, secp384r1, secp521r1,
prime192v1, prime192v2, prime192v3, prime239v1, prime239v2,
prime239v3, c2pnb163v1, c2pnb163v2, c2pnb163v3, c2pnb176v1,
c2tnb191v1, c2tnb191v2, c2tnb191v3, c2pnb208w1, c2tnb239v1,
c2tnb239v2, c2tnb239v3, c2pnb272w1, c2pnb304w1, c2tnb359w1,
c2pnb368w1, c2tnb431r1, secp112r1, secp112r2, secp128r1,
secp128r2, sect113r1, sect113r2, sect131r1,
sect131r2</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-r</font></p>

<p style="margin-left:14%;"><font color="#000000">Display a
certificate's binary DER encoding when listing information
about that certificate with the -L option.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-s
subject</font></p>

<p style="margin-left:14%;"><font color="#000000">Identify
a particular certificate owner for new certificates or
certificate requests. Bracket this string with quotation
marks if it contains spaces. The subject identification
format follows RFC #1485.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-t
trustargs</font></p>

<p style="margin-left:14%;"><font color="#000000">Specify
the trust attributes to modify in an existing certificate or
to apply to a certificate when creating it or adding it to a
database. There are three available trust categories for
each certificate, expressed in the order <i>SSL, email,
object signing</i> for each trust setting. In each category
position, use none, any, or all of the attribute
codes:</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
<b>p</b> - Valid peer</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
<b>P</b> - Trusted peer (implies p)</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
<b>c</b> - Valid CA</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
<b>C</b> - Trusted CA (implies c)</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
<b>T</b> - trusted CA for client authentication (ssl server
only)</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">The
attribute codes for the categories are separated by commas,
and the entire set of attributes enclosed by quotation
marks. For example:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000"><b>-t
&quot;TC,C,T&quot;</b></font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">Use
the -L option to see a list of the current certificates and
trust attributes in a certificate database.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">Note
that the output of the -L option may include &quot;u&quot;
flag, which means that there is a private key associated
with the certificate. It is a dynamic flag and you cannot
set it with certutil.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-u
certusage</font></p>

<p style="margin-left:14%;"><font color="#000000">Specify a
usage context to apply when validating a certificate with
the -V option.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">The
contexts are the following:</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
<b>C</b> (as an SSL client)</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
<b>V</b> (as an SSL server)</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
<b>L</b> (as an SSL CA)</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
<b>A</b> (as Any CA)</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
<b>Y</b> (Verify CA)</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
<b>S</b> (as an email signer)</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
<b>R</b> (as an email recipient)</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
<b>O</b> (as an OCSP status responder)</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
<b>J</b> (as an object signer)</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
<b>I</b> (as an IPSEC user)</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-v
valid-months</font></p>

<p style="margin-left:14%;"><font color="#000000">Set the
number of months a new certificate will be valid. The
validity period begins at the current system time unless an
offset is added or subtracted with the <b>-w</b> option. If
this argument is not used, the default validity period is
three months.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-w
offset-months</font></p>

<p style="margin-left:14%;"><font color="#000000">Set an
offset from the current system time, in months, for the
beginning of a certificate's validity period. Use when
creating the certificate or adding it to a database. Express
the offset in integers, using a minus sign (-) to indicate a
negative offset. If this argument is not used, the validity
period begins at the current system time. The length of the
validity period is set with the -v argument.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-X</font></p>

<p style="margin-left:14%;"><font color="#000000">Force the
key and certificate database to open in read-write mode.
This is used with the <b>-U</b> and <b>-L</b> command
options.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-x</font></p>

<p style="margin-left:14%;"><font color="#000000">Use
<b>certutil</b> to generate the signature for a certificate
being created or added to a database, rather than obtaining
a signature from a separate CA.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-y
exp</font></p>

<p style="margin-left:14%;"><font color="#000000">Set an
alternate exponent value to use in generating a new RSA
public key for the database, instead of the default value of
65537. The available alternate values are 3 and
17.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--pss</font></p>

<p style="margin-left:14%;"><font color="#000000">Restrict
the generated certificate (with the <b>-S</b> option) or
certificate request (with the <b>-R</b> option) to be used
with the RSA-PSS signature scheme. This only works when the
private key of the certificate or certificate request is
RSA.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--pss-sign</font></p>

<p style="margin-left:14%;"><font color="#000000">Sign the
generated certificate with the RSA-PSS signature scheme
(with the <b>-C</b> or <b>-S</b> option). This only works
when the private key of the signer's certificate is RSA. If
the signer's certificate is restricted to RSA-PSS, it is not
necessary to specify this option.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-z
noise-file</font></p>

<p style="margin-left:14%;"><font color="#000000">Read a
seed value from the specified file to generate a new private
and public key pair. This argument makes it possible to use
hardware-generated seed values or manually create a value
from the keyboard. The minimum file size is 20
bytes.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-Z
hashAlg</font></p>

<p style="margin-left:14%;"><font color="#000000">Specify
the hash algorithm to use with the -C, -S or -R command
options. Possible keywords:</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
MD2</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
MD4</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
MD5</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
SHA1</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
SHA224</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
SHA256</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
SHA384</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
SHA512</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-0
SSO_password</font></p>

<p style="margin-left:14%;"><font color="#000000">Set a
site security officer password on a token.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-1
| --keyUsage keyword,keyword</font></p>

<p style="margin-left:14%;"><font color="#000000">Set an
X.509 V3 Certificate Type Extension in the certificate.
There are several available keywords:</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
digitalSignature</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
nonRepudiation</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
keyEncipherment</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
dataEncipherment</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
keyAgreement</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
certSigning</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
crlSigning</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
critical</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-2</font></p>

<p style="margin-left:14%;"><font color="#000000">Add a
basic constraint extension to a certificate that is being
created or added to a database. This extension supports the
certificate chain verification process. <b>certutil</b>
prompts for the certificate constraint extension to
select.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">X.509
certificate extensions are described in RFC 5280.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-3</font></p>

<p style="margin-left:14%;"><font color="#000000">Add an
authority key ID extension to a certificate that is being
created or added to a database. This extension supports the
identification of a particular certificate, from among
multiple certificates associated with one subject name, as
the correct issuer of a certificate. The Certificate
Database Tool will prompt you to select the authority key ID
extension.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">X.509
certificate extensions are described in RFC 5280.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-4</font></p>

<p style="margin-left:14%;"><font color="#000000">Add a CRL
distribution point extension to a certificate that is being
created or added to a database. This extension identifies
the URL of a certificate's associated certificate revocation
list (CRL). <b>certutil</b> prompts for the URL.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">X.509
certificate extensions are described in RFC 5280.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-5
| --nsCertType keyword,keyword</font></p>

<p style="margin-left:14%;"><font color="#000000">Add an
X.509 V3 certificate type extension to a certificate that is
being created or added to the database. There are several
available keywords:</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
sslClient</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
sslServer</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
smime</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
objectSigning</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
sslCA</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
smimeCA</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
objectSigningCA</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
critical</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">X.509
certificate extensions are described in RFC 5280.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-6
| --extKeyUsage keyword,keyword</font></p>

<p style="margin-left:14%;"><font color="#000000">Add an
extended key usage extension to a certificate that is being
created or added to the database. Several keywords are
available:</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
serverAuth</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
clientAuth</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
codeSigning</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
emailProtection</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
timeStamp</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
ocspResponder</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
stepUp</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
msTrustListSign</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
critical</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
x509Any</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
ipsecIKE</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
ipsecIKEEnd</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
ipsecIKEIntermediate</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
ipsecEnd</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
ipsecTunnel</font></p>


<p style="margin-left:19%; margin-top: 1em"><font color="#000000">&bull;
ipsecUser</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">X.509
certificate extensions are described in RFC 5280.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-7
emailAddrs</font></p>

<p style="margin-left:14%;"><font color="#000000">Add a
comma-separated list of email addresses to the subject
alternative name extension of a certificate or certificate
request that is being created or added to the database.
Subject alternative name extensions are described in Section
4.2.1.7 of RFC 3280.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-8
dns-names</font></p>

<p style="margin-left:14%;"><font color="#000000">Add a
comma-separated list of DNS names to the subject alternative
name extension of a certificate or certificate request that
is being created or added to the database. Subject
alternative name extensions are described in Section 4.2.1.7
of RFC 3280.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--extAIA</font></p>

<p style="margin-left:14%;"><font color="#000000">Add the
Authority Information Access extension to the certificate.
X.509 certificate extensions are described in RFC
5280.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--extSIA</font></p>

<p style="margin-left:14%;"><font color="#000000">Add the
Subject Information Access extension to the certificate.
X.509 certificate extensions are described in RFC
5280.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--extCP</font></p>

<p style="margin-left:14%;"><font color="#000000">Add the
Certificate Policies extension to the certificate. X.509
certificate extensions are described in RFC 5280.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--extPM</font></p>

<p style="margin-left:14%;"><font color="#000000">Add the
Policy Mappings extension to the certificate. X.509
certificate extensions are described in RFC 5280.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--extPC</font></p>

<p style="margin-left:14%;"><font color="#000000">Add the
Policy Constraints extension to the certificate. X.509
certificate extensions are described in RFC 5280.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--extIA</font></p>

<p style="margin-left:14%;"><font color="#000000">Add the
Inhibit Any Policy Access extension to the certificate.
X.509 certificate extensions are described in RFC
5280.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--extSKID</font></p>

<p style="margin-left:14%;"><font color="#000000">Add the
Subject Key ID extension to the certificate. X.509
certificate extensions are described in RFC 5280.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--extNC</font></p>

<p style="margin-left:14%;"><font color="#000000">Add a
Name Constraint extension to the certificate. X.509
certificate extensions are described in RFC 5280.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--extSAN
type:name[,type:name]...</font></p>

<p style="margin-left:14%;"><font color="#000000">Create a
Subject Alt Name extension with one or multiple
names.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">-type:
directory, dn, dns, edi, ediparty, email, ip, ipaddr, other,
registerid, rfc822, uri, x400, x400addr</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--empty-password</font></p>

<p style="margin-left:14%;"><font color="#000000">Use empty
password when creating new certificate database with
-N.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--keyAttrFlags
attrflags</font></p>

<p style="margin-left:14%;"><font color="#000000">PKCS #11
key Attributes. Comma separated list of key attribute flags,
selected from the following list of choices: {token |
session} {public | private} {sensitive | insensitive}
{modifiable | unmodifiable} {extractable |
unextractable}</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--keyOpFlagsOn
opflags, --keyOpFlagsOff opflags</font></p>

<p style="margin-left:14%;"><font color="#000000">PKCS #11
key Operation Flags. Comma separated list of one or more of
the following: {token | session} {public | private}
{sensitive | insensitive} {modifiable | unmodifiable}
{extractable | unextractable}</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--new-n
nickname</font></p>

<p style="margin-left:14%;"><font color="#000000">A new
nickname, used when renaming a certificate.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--source-dir
certdir</font></p>

<p style="margin-left:14%;"><font color="#000000">Identify
the certificate database directory to upgrade.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--source-prefix
certdir</font></p>

<p style="margin-left:14%;"><font color="#000000">Give the
prefix of the certificate and key databases to
upgrade.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--upgrade-id
uniqueID</font></p>

<p style="margin-left:14%;"><font color="#000000">Give the
unique ID of the database to upgrade.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">--upgrade-token-name
name</font></p>

<p style="margin-left:14%;"><font color="#000000">Set the
name of the token to use while it is being
upgraded.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">-@
pwfile</font></p>

<p style="margin-left:14%;"><font color="#000000">Give the
name of a password file to use for the database being
upgraded.</font></p>

<h2>USAGE AND EXAMPLES
<a name="USAGE AND EXAMPLES"></a>
</h2>



<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Most
of the command options in the examples listed here have more
arguments available. The arguments included in these
examples are the most common ones or are used to illustrate
a specific scenario. Use the <b>-H</b> option to show the
complete list of arguments for each command
option.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>Creating
New Security Databases</b></font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Certificates,
keys, and security modules related to managing certificates
are stored in three related databases:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
cert8.db or cert9.db</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
key3.db or key4.db</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
secmod.db or pkcs11.txt</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">These
databases must be created before certificates or keys can be
generated.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">certutil
-N -d directory</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>Creating
a Certificate Request</b></font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">A
certificate request contains most or all of the information
that is used to generate the final certificate. This request
is submitted separately to a certificate authority and is
then approved by some mechanism (automatically or by human
review). Once the request is approved, then the certificate
is generated.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -R -k key-type-or-id [-q pqgfile|curve-name] -g
key-size -s subject [-h tokenname] -d directory [-p phone]
[-o output-file] [-a]</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">The
<b>-R</b> command options requires four
arguments:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
<b>-k</b> to specify either the key type to generate or,
when renewing a certificate, the existing key pair to
use</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
<b>-g</b> to set the keysize of the key to
generate</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
<b>-s</b> to set the subject name of the
certificate</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
<b>-d</b> to give the security database directory</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">The
new certificate request can be output in ASCII format
(<b>-a</b>) or can be written to a specified file
(<b>-o</b>).</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">For
example:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -R -k rsa -g 1024 -s &quot;CN=John Smith,O=Example
Corp,L=Mountain View,ST=California,C=US&quot; -d $HOME/nssdb
-p 650-555-0123 -a -o cert.cer</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">Generating
key. This may take a few moments...</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>Creating
a Certificate</b></font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">A
valid certificate must be issued by a trusted CA. This can
be done by specifying a CA certificate (<b>-c</b>) that is
stored in the certificate database. If a CA key pair is not
available, you can create a self-signed certificate using
the <b>-x</b> argument with the <b>-S</b> command
option.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -S -k rsa|dsa|ec -n certname -s subject [-c issuer
|-x] -t trustargs -d directory [-m serial-number] [-v
valid-months] [-w offset-months] [-p phone] [-1] [-2] [-3]
[-4] [-5 keyword] [-6 keyword] [-7 emailAddress] [-8
dns-names] [--extAIA] [--extSIA] [--extCP] [--extPM]
[--extPC] [--extIA] [--extSKID]</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">The
series of numbers and <b>--ext*</b> options set certificate
extensions that can be added to the certificate when it is
generated by the CA. Interactive prompts will
result.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">For
example, this creates a self-signed certificate:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -S -s &quot;CN=Example CA&quot; -n my-ca-cert -x -t
&quot;C,C,C&quot; -1 -2 -5 -m 3650</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">The
interative prompts for key usage and whether any extensions
are critical and responses have been ommitted for
brevity.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">From
there, new certificates can reference the self-signed
certificate:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -S -s &quot;CN=My Server Cert&quot; -n
my-server-cert -c &quot;my-ca-cert&quot; -t &quot;,,&quot;
-1 -5 -6 -8 -m 730</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>Generating
a Certificate from a Certificate Request</b></font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">When
a certificate request is created, a certificate can be
generated by using the request and then referencing a
certificate authority signing certificate (the <i>issuer</i>
specified in the <b>-c</b> argument). The issuing
certificate must be in the certificate database in the
specified directory.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">certutil
-C -c issuer -i cert-request-file -o output-file [-m
serial-number] [-v valid-months] [-w offset-months] -d
directory [-1] [-2] [-3] [-4] [-5 keyword] [-6 keyword] [-7
emailAddress] [-8 dns-names]</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">For
example:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -C -c &quot;my-ca-cert&quot; -i
/home/certs/cert.req -o cert.cer -m 010 -v 12 -w 1 -d
$HOME/nssdb -1 nonRepudiation,dataEncipherment -5 sslClient
-6 clientAuth -7 jsmith@example.com</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>Listing
Certificates</b></font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">The
<b>-L</b> command option lists all of the certificates
listed in the certificate database. The path to the
directory (<b>-d</b>) is required.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -L -d /home/my/sharednssdb</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">Certificate
Nickname Trust Attributes <br>
SSL,S/MIME,JAR/XPI</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">CA
Administrator of Instance pki-ca1's Example Domain ID u,u,u
<br>
TPS Administrator's Example Domain ID u,u,u <br>
Google Internet Authority ,, <br>
Certificate Authority - Example Domain CT,C,C</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Using
additional arguments with <b>-L</b> can return and print the
information for a single, specific certificate. For example,
the <b>-n</b> argument passes the certificate name, while
the <b>-a</b> argument prints the certificate in ASCII
format:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -L -d $HOME/nssdb -a -n my-ca-cert <br>
-----BEGIN CERTIFICATE----- <br>

MIIB1DCCAT2gAwIBAgICDkIwDQYJKoZIhvcNAQEFBQAwFTETMBEGA1UEAxMKRXhh
<br>

bXBsZSBDQTAeFw0xMzAzMTMxOTEwMjlaFw0xMzA2MTMxOTEwMjlaMBUxEzARBgNV
<br>

BAMTCkV4YW1wbGUgQ0EwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAJ4Kzqvz
<br>

JyBVgFqDXRYSyTBNw1DrxUU/3GvWA/ngjAwHEv0Cul/6sO/gsCvnABHiH6unns6x
<br>

XRzPORlC2WY3gkk7vmlsLvYpyecNazAi/NAwVnU/66HOsaoVFWE+gBQo99UrN2yk
<br>

0BiK/GMFlLm5dXQROgA9ZKKyFdI0LIXtf6SbAgMBAAGjMzAxMBEGCWCGSAGG+EIB
<br>

AQQEAwIHADAMBgNVHRMEBTADAQH/MA4GA1UdDwEB/wQEAwICBDANBgkqhkiG9w0B
<br>

AQUFAAOBgQA6chkzkACN281d1jKMrc+RHG2UMaQyxiteaLVZO+Ro1nnRUvseDf09
<br>

XKYFwPMJjWCihVku6bw/ihZfuMHhxK22Nue6inNQ6eDu7WmrqL8z3iUrQwxs+WiF
<br>
ob2rb8XRVVJkzXdXxlk4uo3UtNvw8sAz7sWD71qxKaIHU5q49zijfg==
<br>
-----END CERTIFICATE-----</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">For
a human-readable display</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -L -d $HOME/nssdb -n my-ca-cert <br>
Certificate: <br>
Data: <br>
Version: 3 (0x2) <br>
Serial Number: 3650 (0xe42) <br>
Signature Algorithm: PKCS #1 SHA-1 With RSA Encryption <br>
Issuer: &quot;CN=Example CA&quot; <br>
Validity: <br>
Not Before: Wed Mar 13 19:10:29 2013 <br>
Not After : Thu Jun 13 19:10:29 2013 <br>
Subject: &quot;CN=Example CA&quot; <br>
Subject Public Key Info: <br>
Public Key Algorithm: PKCS #1 RSA Encryption <br>
RSA Public Key: <br>
Modulus: <br>
9e:0a:ce:ab:f3:27:20:55:80:5a:83:5d:16:12:c9:30: <br>
4d:c3:50:eb:c5:45:3f:dc:6b:d6:03:f9:e0:8c:0c:07: <br>
12:fd:02:ba:5f:fa:b0:ef:e0:b0:2b:e7:00:11:e2:1f: <br>
ab:a7:9e:ce:b1:5d:1c:cf:39:19:42:d9:66:37:82:49: <br>
3b:be:69:6c:2e:f6:29:c9:e7:0d:6b:30:22:fc:d0:30: <br>
56:75:3f:eb:a1:ce:b1:aa:15:15:61:3e:80:14:28:f7: <br>
d5:2b:37:6c:a4:d0:18:8a:fc:63:05:94:b9:b9:75:74: <br>
11:3a:00:3d:64:a2:b2:15:d2:34:2c:85:ed:7f:a4:9b <br>
Exponent: 65537 (0x10001) <br>
Signed Extensions: <br>
Name: Certificate Type <br>
Data: none</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">Name:
Certificate Basic Constraints <br>
Data: Is a CA with no maximum path length.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">Name:
Certificate Key Usage <br>
Critical: True <br>
Usages: Certificate Signing</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">Signature
Algorithm: PKCS #1 SHA-1 With RSA Encryption <br>
Signature: <br>
3a:72:19:33:90:00:8d:db:cd:5d:d6:32:8c:ad:cf:91: <br>
1c:6d:94:31:a4:32:c6:2b:5e:68:b5:59:3b:e4:68:d6: <br>
79:d1:52:fb:1e:0d:fd:3d:5c:a6:05:c0:f3:09:8d:60: <br>
a2:85:59:2e:e9:bc:3f:8a:16:5f:b8:c1:e1:c4:ad:b6: <br>
36:e7:ba:8a:73:50:e9:e0:ee:ed:69:ab:a8:bf:33:de: <br>
25:2b:43:0c:6c:f9:68:85:a1:bd:ab:6f:c5:d1:55:52: <br>
64:cd:77:57:c6:59:38:ba:8d:d4:b4:db:f0:f2:c0:33: <br>
ee:c5:83:ef:5a:b1:29:a2:07:53:9a:b8:f7:38:a3:7e <br>
Fingerprint (MD5): <br>
86:D8:A5:8B:8A:26:BE:9E:17:A8:7B:66:10:6B:27:80 <br>
Fingerprint (SHA1): <br>

48:78:09:EF:C5:D4:0C:BD:D2:64:45:59:EB:03:13:15:F7:A9:D6:F7</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">Certificate
Trust Flags: <br>
SSL Flags: <br>
Valid CA <br>
Trusted CA <br>
User <br>
Email Flags: <br>
Valid CA <br>
Trusted CA <br>
User <br>
Object Signing Flags: <br>
Valid CA <br>
Trusted CA <br>
User</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>Listing
Keys</b></font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Keys
are the original material used to encrypt certificate data.
The keys generated for certificates are stored separately,
in the key database.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">To
list all keys in the database, use the <b>-K</b> command
option and the (required) <b>-d</b> argument to give the
path to the directory.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -K -d $HOME/nssdb <br>
certutil: Checking token &quot;NSS Certificate DB&quot; in
slot &quot;NSS User Private Key and Certificate Services
&quot; <br>
&lt; 0&gt; rsa 455a6673bde9375c2887ec8bf8016b3f9f35861d
Thawte Freemail Member's Thawte Consulting (Pty) Ltd. ID
<br>
&lt; 1&gt; rsa 40defeeb522ade11090eacebaaf1196a172127df
Example Domain Administrator Cert <br>
&lt; 2&gt; rsa 1d0b06f44f6c03842f7d4f4a1dc78b3bcd1b85a5 John
Smith user cert</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">There
are ways to narrow the keys listed in the search
results:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
To return a specific key, use the <b>-n</b> <i>name</i>
argument with the name of the key.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
If there are multiple security devices loaded, then the
<b>-h</b> <i>tokenname</i> argument can search a specific
token or all tokens.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
If there are multiple key types available, then the
<b>-k</b> <i>key-type</i> argument can search a specific
type of key, like RSA, DSA, or ECC.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>Listing
Security Modules</b></font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">The
devices that can be used to store certificates -- both
internal databases and external devices like smart cards --
are recognized and used by loading security modules. The
<b>-U</b> command option lists all of the security modules
listed in the secmod.db database. The path to the directory
(<b>-d</b>) is required.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -U -d /home/my/sharednssdb</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">slot:
NSS User Private Key and Certificate Services <br>
token: NSS Certificate DB <br>
uri:
pkcs11:token=NSS%20Certificate%20DB;manufacturer=Mozilla%20Foundation;serial=0000000000000000;model=NSS%203</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">slot:
NSS Internal Cryptographic Services <br>
token: NSS Generic Crypto Services <br>
uri:
pkcs11:token=NSS%20Generic%20Crypto%20Services;manufacturer=Mozilla%20Foundation;serial=0000000000000000;model=NSS%203</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>Adding
Certificates to the Database</b></font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Existing
certificates or certificate requests can be added manually
to the certificate database, even if they were generated
elsewhere. This uses the <b>-A</b> command
option.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">certutil
-A -n certname -t trustargs -d directory [-a] [-i
input-file]</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">For
example:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -A -n &quot;CN=My SSL Certificate&quot; -t
&quot;,,&quot; -d /home/my/sharednssdb -i
/home/example-certs/cert.cer</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">A
related command option, <b>-E</b>, is used specifically to
add email certificates to the certificate database. The
<b>-E</b> command has the same arguments as the <b>-A</b>
command. The trust arguments for certificates have the
format <i>SSL,S/MIME,Code-signing</i>, so the middle trust
settings relate most to email certificates (though the
others can be set). For example:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -E -n &quot;CN=John Smith Email Cert&quot; -t
&quot;,P,&quot; -d /home/my/sharednssdb -i
/home/example-certs/email.cer</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>Deleting
Certificates to the Database</b></font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Certificates
can be deleted from a database using the <b>-D</b> option.
The only required options are to give the security database
directory and to identify the certificate
nickname.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">certutil
-D -d directory -n &quot;nickname&quot;</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">For
example:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -D -d /home/my/sharednssdb -n
&quot;my-ssl-cert&quot;</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>Validating
Certificates</b></font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">A
certificate contains an expiration date in itself, and
expired certificates are easily rejected. However,
certificates can also be revoked before they hit their
expiration date. Checking whether a certificate has been
revoked requires validating the certificate. Validation can
also be used to ensure that the certificate is only used for
the purposes it was initially issued for. Validation is
carried out by the <b>-V</b> command option.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">certutil
-V -n certificate-name [-b time] [-e] [-u cert-usage] -d
directory</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">For
example, to validate an email certificate:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -V -n &quot;John Smith's Email Cert&quot; -e -u S,R
-d /home/my/sharednssdb</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>Modifying
Certificate Trust Settings</b></font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">The
trust settings (which relate to the operations that a
certificate is allowed to be used for) can be changed after
a certificate is created or added to the database. This is
especially useful for CA certificates, but it can be
performed for any type of certificate.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">certutil
-M -n certificate-name -t trust-args -d directory</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">For
example:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -M -n &quot;My CA Certificate&quot; -d
/home/my/sharednssdb -t &quot;CT,CT,CT&quot;</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>Printing
the Certificate Chain</b></font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Certificates
can be issued in <i>chains</i> because every certificate
authority itself has a certificate; when a CA issues a
certificate, it essentially stamps that certificate with its
own fingerprint. The <b>-O</b> prints the full chain of a
certificate, going from the initial CA (the root CA) through
ever intermediary CA to the actual certificate. For example,
for an email certificate with two CAs in the
chain:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -d /home/my/sharednssdb -O -n
&quot;jsmith@example.com&quot; <br>
&quot;Builtin Object Token:Thawte Personal Freemail CA&quot;
[E=personal-freemail@thawte.com,CN=Thawte Personal Freemail
CA,OU=Certification Services Division,O=Thawte
Consulting,L=Cape Town,ST=Western Cape,C=ZA]</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&quot;Thawte
Personal Freemail Issuing CA - Thawte Consulting&quot;
[CN=Thawte Personal Freemail Issuing CA,O=Thawte Consulting
(Pty) Ltd.,C=ZA]</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&quot;(null)&quot;
[E=jsmith@example.com,CN=Thawte Freemail Member]</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>Resetting
a Token</b></font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">The
device which stores certificates -- both external hardware
devices and internal software databases -- can be blanked
and reused. This operation is performed on the device which
stores the data, not directly on the security databases, so
the location must be referenced through the token name
(<b>-h</b>) as well as any directory path. If there is no
external token used, the default value is
internal.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">certutil
-T -d directory -h token-name -0
security-officer-password</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Many
networks have dedicated personnel who handle changes to
security tokens (the security officer). This person must
supply the password to access the specified token. For
example:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -T -d /home/my/sharednssdb -h nethsm -0
secret</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>Upgrading
or Merging the Security Databases</b></font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Many
networks or applications may be using older BerkeleyDB
versions of the certificate database (cert8.db). Databases
can be upgraded to the new SQLite version of the database
(cert9.db) using the <b>--upgrade-merge</b> command option
or existing databases can be merged with the new cert9.db
databases using the <b>---merge</b> command.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">The
<b>--upgrade-merge</b> command must give information about
the original database and then use the standard arguments
(like <b>-d</b>) to give the information about the new
databases. The command also requires information that the
tool uses for the process to upgrade and write over the
original database.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">certutil
--upgrade-merge -d directory [-P dbprefix] --source-dir
directory --source-prefix dbprefix --upgrade-id id
--upgrade-token-name name [-@ password-file]</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">For
example:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil --upgrade-merge -d /home/my/sharednssdb
--source-dir /opt/my-app/alias/ --source-prefix serverapp-
--upgrade-id 1 --upgrade-token-name internal</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">The
<b>--merge</b> command only requires information about the
location of the original database; since it doesn't change
the format of the database, it can write over information
without performing interim step.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">certutil
--merge -d directory [-P dbprefix] --source-dir directory
--source-prefix dbprefix [-@ password-file]</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">For
example:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil --merge -d /home/my/sharednssdb --source-dir
/opt/my-app/alias/ --source-prefix serverapp-</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>Running
certutil Commands from a Batch File</b></font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">A
series of commands can be run sequentially from a text file
with the <b>-B</b> command option. The only argument for
this specifies the input file.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -B -i /path/to/batch-file</font></p>

<h2>NSS DATABASE TYPES
<a name="NSS DATABASE TYPES"></a>
</h2>



<p style="margin-left:9%; margin-top: 1em"><font color="#000000">NSS
originally used BerkeleyDB databases to store security
information. The last versions of these <i>legacy</i>
databases are:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
cert8.db for certificates</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
key3.db for keys</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
secmod.db for PKCS #11 module information</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">BerkeleyDB
has performance limitations, though, which prevent it from
being easily used by multiple applications simultaneously.
NSS has some flexibility that allows applications to use
their own, independent database engine while keeping a
shared database and working around the access issues. Still,
NSS requires more flexibility to provide a truly shared
security database.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">In
2009, NSS introduced a new set of databases that are SQLite
databases rather than BerkeleyDB. These new databases
provide more accessibility and performance:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
cert9.db for certificates</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
key4.db for keys</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
pkcs11.txt, a listing of all of the PKCS #11 modules,
contained in a new subdirectory in the security databases
directory</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Because
the SQLite databases are designed to be shared, these are
the <i>shared</i> database type. The shared database type is
preferred; the legacy format is included for backward
compatibility.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">By
default, the tools (<b>certutil</b>, <b>pk12util</b>,
<b>modutil</b>) assume that the given security databases use
the SQLite type. Using the legacy databases must be manually
specified by using the <b>dbm:</b> prefix with the given
security directory. For example:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
certutil -L -d dbm:/home/my/sharednssdb</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">To
set the legacy database type as the default type for the
tools, set the <b>NSS_DEFAULT_DB_TYPE</b> environment
variable to <b>dbm</b>:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">export
NSS_DEFAULT_DB_TYPE=&quot;dbm&quot;</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">This
line can be set added to the &#732;/.bashrc file to make the
change permanent.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
https://wiki.mozilla.org/NSS_Shared_DB_Howto</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">For
an engineering draft on the changes in the shared NSS
databases, see the NSS project wiki:</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
https://wiki.mozilla.org/NSS_Shared_DB</font></p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:9%; margin-top: 1em"><font color="#000000">pk12util
(1)</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">modutil
(1)</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>certutil</b>
has arguments or operations that use features defined in
several IETF RFCs.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
http://tools.ietf.org/html/rfc5280</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
http://tools.ietf.org/html/rfc1113</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
http://tools.ietf.org/html/rfc1485</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">The
NSS wiki has information on the new database design and how
to configure applications to use it.</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
https://wiki.mozilla.org/NSS_Shared_DB_Howto</font></p>


<p style="margin-left:14%; margin-top: 1em"><font color="#000000">&bull;
https://wiki.mozilla.org/NSS_Shared_DB</font></p>

<h2>ADDITIONAL RESOURCES
<a name="ADDITIONAL RESOURCES"></a>
</h2>



<p style="margin-left:9%; margin-top: 1em"><font color="#000000">For
information about NSS and other tools related to NSS (like
JSS), check out the NSS project wiki at</font>
<b><font color="#0000FF">http://www.mozilla.org/projects/security/pki/nss/</font></b><font color="#000000">.
The NSS site relates directly to NSS code changes and
releases.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Mailing
lists:
https://lists.mozilla.org/listinfo/dev-tech-crypto</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">IRC:
Freenode at #dogtag-pki</font></p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>



<p style="margin-left:9%; margin-top: 1em"><font color="#000000">The
NSS tools were written and maintained by developers with
Netscape, Red Hat, Sun, Oracle, Mozilla, and
Google.</font></p>


<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Authors:
Elio Maldonado &lt;emaldona@redhat.com&gt;, Deon Lackey
&lt;dlackey@redhat.com&gt;.</font></p>

<h2>LICENSE
<a name="LICENSE"></a>
</h2>



<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Licensed
under the Mozilla Public License, v. 2.0. If a copy of the
MPL was not distributed with this file, You can obtain one
at http://mozilla.org/MPL/2.0/.</font></p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">1.</font></p> </td>
<td width="1%"></td>
<td width="28%">


<p style="margin-top: 1em"><font color="#000000">Mozilla
NSS bug 836477</font></p></td>
<td width="58%">
</td></tr>
</table>


<p style="margin-left:14%;"><font color="#000000">https://bugzilla.mozilla.org/show_bug.cgi?id=836477</font></p>
<hr>
</body>
</html>
